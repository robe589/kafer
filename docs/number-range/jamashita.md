# jamashita

## Repository

<https://github.com/jamashita/griglia/blob/main/problems/number-range>

## どのぐらいこの問題に時間をかけましたか

`2`日**以上**

## やったことの一覧

1. 値は`0`以上の`20`以下の整数を考えます
    * [x] 下限値と上限値は変更できるようにし、magic numberの使用を避けてください
    * [x] 上限を表す`- X`は範囲の`0 - X`と考えてください
    * [x] 下限を表す`X -`は範囲の`X - 20`と考えてください
1. [x] 文字列が与えられたときに、それをそのデータ構造に変換するためのファクトリメソッドを定義してください
    * 与えられるstring型の引数は必ず正しいものであり、バリデーションは不要です
1. [x] あるnumber型の引数を受けてその値が数値表現と適合するかを判定できるメソッド`isValid()`を定義してください
1. [x] 新しく数値表現を追加できるメソッド`add()`を実装してください
    * 与えられるnumber型の引数は必ず正しいものであり、バリデーションは不要です
1. [x] 新しく数値表現を削除できるメソッド`remove()`を実装してください
    * 与えられるnumber型の引数は必ず正しいものであり、バリデーションは不要です
1. [x] `add(), remove()`によって数値表現を変更できるようにしてください
    * `- 7, 9`に`8`を追加すると`- 9`になります
1. [x] 1値は3値連続すると範囲に変わるようにしてください
    * 1値を追加する想像図は以下です
        * `4` -> `4, 5` -> `4 - 6`
        * `0` -> `0, 1` -> `- 2`
    * [x] 連続する範囲が`remove()`によって取り除かれた場合は表記を離散(複合)に戻してください
        * `1 - 5` -> `1, 2, 4, 5`

## どうやって問題へ取りかかろうとおもいましたか

与えられているインターフェイスが自身の状態変遷をすることが前提の構成だったため作成しづらいと判断し`State pattern`データ切り替えを行い、内部をimmutableに扱うように考えた。  
与えられた要件的に、1値と複数値が考えられたので`Composite pattern`を用いてデータを管理しようと考えた。

## やってみてうまくいったところはなんでしたか

数値表現のクラス構成。Null Object、1値、範囲、複合のクラス構成で作った。

```typescript
// Null Object
[];
// 1値
[2];
// 範囲
[5, 6, 7, 8];
// 複合
[[2], [5, 6, 7, 8]];
```

このうち複合は他の数値表現を含むことができる`Composite pattern`で、何かあれば該当する他の数値表現に対し呼びかけるだけという構成。 他は値を追加したり削除したりすると他の数値表現に切り替わるように作った。

### 1値が範囲になる例

```typescript
[1];
// add 2
[1, 2]
```

### 範囲が複合になる例

```typescript
[5, 6, 7, 8, 9];
// remove 7
[[5, 6], [8, 9]]
```

## やってみてうまくいかなかったところはなんでしたか

問題が与えられた通りに1値、範囲、上限、下限、複合の5クラスを作ってみたが実際にはそこまで必要なかった。  
必要なのは`Null Object pattern`を加えたNull Object、1値、範囲、複合だけだった。
